<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Minimax optimal testing, aiming for a control of false discovery rate à la Benjamini-Hochberg — mediation_test_minimax_BH • mediation.test</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Minimax optimal testing, aiming for a control of false discovery rate à la Benjamini-Hochberg — mediation_test_minimax_BH"><meta name="description" content='Carries   out   the   minimax   optimal  test   of   the   composite   null
"\(\delta_x    \times     \delta_y=0\)"    against     its    alternative
"\(\delta_x \times \delta_y\neq  0\)" based on the test  statistic in the
real  plane,   aiming  for  a  control   of  false  discovery  rate   à  la
Benjamini-Hochberg.'><meta property="og:description" content='Carries   out   the   minimax   optimal  test   of   the   composite   null
"\(\delta_x    \times     \delta_y=0\)"    against     its    alternative
"\(\delta_x \times \delta_y\neq  0\)" based on the test  statistic in the
real  plane,   aiming  for  a  control   of  false  discovery  rate   à  la
Benjamini-Hochberg.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mediation.test</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Minimax optimal testing, aiming for a control of false discovery rate à la Benjamini-Hochberg</h1>

      <div class="d-none name"><code>mediation_test_minimax_BH.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Carries   out   the   minimax   optimal  test   of   the   composite   null
"\(\delta_x    \times     \delta_y=0\)"    against     its    alternative
"\(\delta_x \times \delta_y\neq  0\)" based on the test  statistic in the
real  plane,   aiming  for  a  control   of  false  discovery  rate   à  la
Benjamini-Hochberg.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mediation_test_minimax_BH</span><span class="op">(</span></span>
<span>  <span class="va">t</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  truncation <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  BH <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"statistics"</span>, <span class="st">"pval"</span><span class="op">)</span>,</span>
<span>  sample_size <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  K <span class="op">=</span> <span class="fl">10L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p>A  <code>vector</code>  consisting of  two  <code>numeric</code>s, the  test
statistic in  the real  plane, or a  'n x 2'  <code>matrix</code> of  such test
statistics.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>A positive <code>numeric</code>, the wished false discovery rate.</p></dd>


<dt id="arg-truncation">truncation<a class="anchor" aria-label="anchor" href="#arg-truncation"></a></dt>
<dd><p>A nonnegative  <code>numeric</code> used to bound the rejection
region away  from the null  hypothesis space.  Defaults to 0,  in which
case the  rejection region is minimax optimal.</p></dd>


<dt id="arg-bh">BH<a class="anchor" aria-label="anchor" href="#arg-bh"></a></dt>
<dd><p>A <code>character</code>,  either "statistics" or  "pval", determining
whether the Benjamini-Hochberg  testing procedure is based  on the test
statistics or on the (conservative) p-values.</p></dd>


<dt id="arg-sample-size">sample_size<a class="anchor" aria-label="anchor" href="#arg-sample-size"></a></dt>
<dd><p>A <code>integer</code>  (larger than  one), the size  of the
sample used  to derive the  test statistic. Defaults to  'Inf', meaning
that, under the  null hypothesis, the test statistic is  drawn from the
\(N_2(0,I_2)\) law.  If  the integer is finite, then,  under the null
hypothesis, the test statistic is drawn from the product of two Student
laws with 'sample_size-1' degrees of freedom.</p></dd>


<dt id="arg-k">K<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>An <code>integer</code> (10 by  default) used internally to speed up the
Benjamini-Hochberg  testing procedure  when  it is  based  on the  test
statistics (more details in the  Details section). Must be smaller than
'nrow(t)'.</p>
<p>@details  Suppose  we  are  carrying out  \(J\)  tests.   Starting  from
\(j=1\),  we   increment  \(j\)  until  fewer   than  \(j\)  null
hypotheses  are   rejected  at  level  \(\alpha\times   j/J\)  for  K
consecutive iterations.   Eventually, we reject all  null hypotheses at
level \(\alpha \times  jj/J\), where \(jj\) is  the largest integer
so far for which at least \(jj\) null hypotheses are rejected at this
level.  For  further   details,  we  refer  to   the  technical  report
"Optimal Tests of the Composite Null Hypothesis Arising in Mediation Analysis",
by Miles &amp; Chambaz (2024), https://arxiv.org/abs/2107.07575</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list, consisting  of:</p><dl><dt>t:</dt>
<dd><p>a <code>vector</code> of two
<code>numeric</code>s, the test statistic, or a 'n x 2' <code>matrix</code> of such
test statistics;</p></dd>
  <dt>alpha:</dt>
<dd><p>a <code>numeric</code>, the  false discovery
rate;</p></dd>
 <dt>truncation:</dt>
<dd><p>a  nonnegative <code>numeric</code>, used  to bound
the   rejection   region  away   from   the   null  hypothesis   space</p></dd>

<dt>sample_size:</dt>
<dd><p>an <code>integer</code>,  the size of the  sample used to
derive   the  test   statistic</p></dd>
  <dt>decision:</dt>
<dd><p>a   <code>vector</code>  of
<code>logical</code>s, <code>FALSE</code>  if the  null hypothesis can  be rejected
for the  alternative at  false discovery  rate 'alpha'  and <code>TRUE</code>
otherwise;</p></dd>
  <dt>pval:</dt>
<dd><p>a   <code>vector</code>  of   <code>numeric</code>s,  the
original  (conservative)  p-values  of the  tests;</p></dd>
  <dt>method:</dt>
<dd><p>the
<code>character</code>  "minimax_BH",</p></dd>
 <dt>BH:</dt>
<dd><p>a  <code>character</code>, either
'statistics'  or  'pval',  determining whether  the  Benjamini-Hochberg
testing  procedure  is   based  on  the  test  statistics   or  on  the
(conservative) p-values;</p></dd>
<dt>K:</dt>
<dd><p>the <code>integer</code> K used internally
to speed up the Benjamini-Hochberg procedure based on the test statistics.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mediation_test_minimax.html">mediation_test_minimax()</a></code>, upon which this function builds.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">4</span> <span class="op">*</span> <span class="va">n</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, max <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="va">delta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">epsilon</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">epsilon</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="va">delta</span></span></span>
<span class="r-in"><span><span class="va">mt_BH_stats</span> <span class="op">&lt;-</span> <span class="fu">mediation_test_minimax_BH</span><span class="op">(</span><span class="va">x</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">20</span>, BH <span class="op">=</span> <span class="st">"statistics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mt_BH_stats</span><span class="op">$</span><span class="va">decision</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-in"><span><span class="va">mt_BH_pval</span> <span class="op">&lt;-</span> <span class="fu">mediation_test_minimax_BH</span><span class="op">(</span><span class="va">x</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">20</span>, BH <span class="op">=</span> <span class="st">"pval"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mt_BH_pval</span><span class="op">$</span><span class="va">decision</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 11</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Antoine Chambaz, Caleb Miles.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

