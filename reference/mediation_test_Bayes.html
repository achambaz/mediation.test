<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayes risk optimal testing — mediation_test_Bayes • mediation.test</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayes risk optimal testing — mediation_test_Bayes"><meta name="description" content='Carries  out   the  Bayes   risk  optimal  test   of  the   composite  null
"\(\delta_x    \times     \delta_y=0\)"    against     its    alternative
"\(\delta_x \times \delta_y\neq  0\)" based on the test  statistic in the
real plane.'><meta property="og:description" content='Carries  out   the  Bayes   risk  optimal  test   of  the   composite  null
"\(\delta_x    \times     \delta_y=0\)"    against     its    alternative
"\(\delta_x \times \delta_y\neq  0\)" based on the test  statistic in the
real plane.'><meta property="og:image" content="https://achambaz.github.io/mediation.test/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mediation.test</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/mediation-test.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bayes risk optimal testing</h1>

      <div class="d-none name"><code>mediation_test_Bayes.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Carries  out   the  Bayes   risk  optimal  test   of  the   composite  null
"\(\delta_x    \times     \delta_y=0\)"    against     its    alternative
"\(\delta_x \times \delta_y\neq  0\)" based on the test  statistic in the
real plane.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mediation_test_Bayes</span><span class="op">(</span><span class="va">t</span>, <span class="va">map</span>, sample_size <span class="op">=</span> <span class="cn">Inf</span>, truncation <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p>A  <code>vector</code>  consisting of  two  <code>numeric</code>s, the  test
statistic in  the real  plane, or a  'n x 2'  <code>matrix</code> of  such test
statistics.</p></dd>


<dt id="arg-map">map<a class="anchor" aria-label="anchor" href="#arg-map"></a></dt>
<dd><p>The "map" of rejection  probabilities – the 'map'  item of the
output of function <code>compute_map_rejection_probs</code>.</p></dd>


<dt id="arg-sample-size">sample_size<a class="anchor" aria-label="anchor" href="#arg-sample-size"></a></dt>
<dd><p>An <code>integer</code>  (larger than  one), the size  of the
sample used  to derive the  test statistic. Defaults to  'Inf', meaning
that, under the  null hypothesis, the test statistic is  drawn from the
\(N_2(0,I_2)\) law.  If  the integer is finite, then,  under the null
hypothesis, the test statistic is drawn from the product of two Student
laws with 'sample_size-1' degrees of freedom.</p></dd>


<dt id="arg-truncation">truncation<a class="anchor" aria-label="anchor" href="#arg-truncation"></a></dt>
<dd><p>A nonnegative  <code>numeric</code> used to bound the rejection
region away  from the null  hypothesis space.  Defaults to 0,  in which
case the  rejection region is minimax optimal.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list, consisting  of:</p><dl><dt>t:</dt>
<dd><p>a <code>vector</code> of two
<code>numeric</code>s, the test statistic, or a 'n x 2' <code>matrix</code> of such
test  statistics;</p></dd>
 <dt>alpha:</dt>
<dd><p>a  <code>numeric</code>, the  type-I error;</p></dd>

<dt>truncation:</dt>
<dd><p>a  nonnegative  <code>numeric</code>,  used to  bound  the
rejection    region   away    from   the    null   hypothesis    space</p></dd>

<dt>decision:</dt>
<dd><p>a  <code>vector</code> of  <code>logical</code>s, <code>FALSE</code>  if
the  null hypothesis  can  be  rejected for  the  alternative at  level
'alpha'  and <code>TRUE</code>  otherwise;</p></dd>
  <dt>pval:</dt>
<dd><p>a <code>vector</code>  of
<code>numeric</code>s,  the  p-values  of  the tests,  'NA'  in  this  case;</p></dd>

<dt>method:</dt>
<dd><p>the  <code>character</code> "Bayes";</p></dd>
<dt>map:</dt>
<dd><p>The  "map" of
rejection probabilities  – the  'map' item of  the output  of function
<code>compute_map_rejection_probs</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For details, we refer  to the technical report  "Optimal Tests of
the Composite Null Hypothesis Arising in Mediation Analysis", by
Miles &amp; Chambaz (2024), https://arxiv.org/abs/2107.07575</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">4</span> <span class="op">*</span> <span class="va">n</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, max <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="va">delta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">epsilon</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">epsilon</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="va">delta</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">mt_01_0.05</span> <span class="op">&lt;-</span> <span class="fu">mediation_test_Bayes</span><span class="op">(</span><span class="va">x</span>, map <span class="op">=</span> <span class="va">map_01_0.05</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Testing the composite null 'delta_x * delta_y = 0' against its alternative 'delta_x * delta_y != 0':</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * method:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayes </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * test statictic:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.18499459 -2.4372636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.73777632  1.0076532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1.88850493  0.6674544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -1.62351863  1.1484116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.93584735 -1.7510698</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.01595031  1.7659893</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * wished type-I error:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * loss function:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "0-1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * user-supplied truncation parameter:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * decision [1 rejection(s) overall]: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cannot reject the null for its alternative with confidence 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cannot reject the null for its alternative with confidence 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cannot reject the null for its alternative with confidence 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cannot reject the null for its alternative with confidence 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cannot reject the null for its alternative with confidence 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cannot reject the null for its alternative with confidence 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * (conservative) p-value:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mt_01_0.05</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mediation_test_Bayes-1.png" alt="" width="700" height="433"></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Some points fall outside the range of the figure.</span>
<span class="r-plt img"><img src="mediation_test_Bayes-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="op">(</span><span class="va">mt_quad_0.05_0.1</span> <span class="op">&lt;-</span> <span class="fu">mediation_test_Bayes</span><span class="op">(</span><span class="va">x</span>, map <span class="op">=</span> <span class="va">map_quad_0.05_0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Argument 'truncation' in call to 'mediation_test_Bayes' (0.000000) differs from the one attrached to the provided map (0.100000). Using the first one...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Testing the composite null 'delta_x * delta_y = 0' against its alternative 'delta_x * delta_y != 0':</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * method:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayes </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * test statictic:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.18499459 -2.4372636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.73777632  1.0076532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1.88850493  0.6674544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -1.62351863  1.1484116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.93584735 -1.7510698</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.01595031  1.7659893</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * wished type-I error:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * loss function:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "quadratic"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * user-supplied truncation parameter:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> warning: used a truncation parameter (0.000) different from the map's truncation parameter (0.100)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * decision [2 rejection(s) overall]: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cannot reject the null for its alternative with confidence 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cannot reject the null for its alternative with confidence 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cannot reject the null for its alternative with confidence 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cannot reject the null for its alternative with confidence 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cannot reject the null for its alternative with confidence 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cannot reject the null for its alternative with confidence 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * (conservative) p-value:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mt_quad_0.05_0.1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mediation_test_Bayes-3.png" alt="" width="700" height="433"></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Some points fall outside the range of the figure.</span>
<span class="r-plt img"><img src="mediation_test_Bayes-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Antoine Chambaz, Caleb Miles.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

