<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introducing the `mediation.test` package • mediation.test</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introducing the `mediation.test` package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mediation.test</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/mediation-test.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introducing the `mediation.test` package</h1>
            
      

      <div class="d-none name"><code>mediation-test.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we illustrate the use of the package
<code>mediation.test</code> by reproducing the simulation study reported
in <span class="citation">Miles and Chambaz (2024)</span>. Our objective
is to compare the finite sample performances of our proposed tests with
those of the delta method, joint significance, and van Garderen and van
Giersbergen (henceforth vGvG, <span class="citation">Garderen and
Giersbergen (2022)</span>) tests.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://achambaz.github.io/mediation.test/">mediation.test</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="simulation-settings">1 Simulation settings<a class="anchor" aria-label="anchor" href="#simulation-settings"></a>
</h2>
<div class="section level3">
<h3 id="simulation-scenarios">Simulation scenarios<a class="anchor" aria-label="anchor" href="#simulation-scenarios"></a>
</h3>
<p>We will sample independently
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mi>e</mi><mn>5</mn></mrow><annotation encoding="application/x-tex">k=1e5</annotation></semantics></math>
data points from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-distributions
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(n-1)</annotation></semantics></math>
degrees of freedom and noncentrality parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mi>n</mi></msqrt><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>δ</mi><mi>x</mi></msub><mo>,</mo><msub><mi>δ</mi><mi>y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sqrt{n}(\delta_x ,
\delta_y)</annotation></semantics></math>, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">n=50</annotation></semantics></math>.
Three simulation scenarios are considered:</p>
<ol style="list-style-type: lower-alpha">
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mi>x</mi></msub><annotation encoding="application/x-tex">\delta_x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mi>y</mi></msub><annotation encoding="application/x-tex">\delta_y</annotation></semantics></math>
vary jointly from 0 to 0.4;</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>y</mi></msub><mo>=</mo><mn>0.2</mn></mrow><annotation encoding="application/x-tex">\delta_y=0.2</annotation></semantics></math>
is fixed while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mi>x</mi></msub><annotation encoding="application/x-tex">\delta_x</annotation></semantics></math>
varies from 0 to 0.4;</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>y</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta_y=0</annotation></semantics></math>
is fixed while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mi>x</mi></msub><annotation encoding="application/x-tex">\delta_x</annotation></semantics></math>
varies from 0 to 0.6, thereby exploring empirical type I error across a
range of parameter values within the composite null hypothesis
space.</p></li>
</ol>
<p>To do so, we will repeatedly use the function defined below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span></span>
<span><span class="va">simulate</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">delta_x</span>, <span class="va">delta_y</span>, <span class="va">k</span> <span class="op">=</span> <span class="fl">1e5</span>, <span class="va">n</span> <span class="op">=</span> <span class="va">n_obs</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Xn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">rt</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="va">delta_x</span><span class="op">)</span></span>
<span>    <span class="va">Yn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">rt</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="va">delta_y</span><span class="op">)</span></span>
<span>    <span class="va">Zn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Xn</span>, <span class="va">Yn</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">Zn</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>All the testing procedures will aim for a type I error
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.05</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="minimax-optimal-test">Minimax optimal test<a class="anchor" aria-label="anchor" href="#minimax-optimal-test"></a>
</h3>
<p>Three version of the minimax optimal test will be evaluated using the
function <code>mediation_test_minimax</code>:</p>
<ul>
<li><p>the standard version, using the normal approximation of the test
statistic;</p></li>
<li><p>the test based on the corresponding (conservative)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
defined in the Supplementary Materials of <span class="citation">Miles
and Chambaz (2024)</span>;</p></li>
<li><p>a truncated minimax optimal test at level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">d = 0.1</annotation></semantics></math>,
in order to make a fair comparison with the vGvG test, whose rejection
region is 0.1 away from the null hypothesis space.</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="cn">Inf</span></span>
<span><span class="va">quantile_function</span> <span class="op">&lt;-</span> <span class="va">qnorm</span></span>
<span><span class="va">truncation</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bayes-risk-optimal-test">Bayes risk optimal test<a class="anchor" aria-label="anchor" href="#bayes-risk-optimal-test"></a>
</h3>
<p>Three versions of the Bayes risk optimal test will be evaluated using
the function <code>mediation_test_Bayes</code>:</p>
<ul>
<li><p>the standard version with 0-1 loss function,</p></li>
<li><p>the standard version with quadratic loss function,</p></li>
<li><p>and the constrained test with quadratic loss function.</p></li>
</ul>
<p>We rely on the “maps” of rejection probabilities embarked in the
package. In both the constrained and truncated tests, we also use a
truncation at level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">d
= 0.1</annotation></semantics></math>. Each “map” associates a rejection
probability to every square
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>−</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mi>m</mi></mfrac><mo>,</mo><mfrac><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>−</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mi>m</mi></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>×</mo><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo>−</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mi>m</mi></mfrac><mo>,</mo><mfrac><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo>−</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mi>m</mi></mfrac><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
\left[\frac{B(i-1-m)}{m},        \frac{B(i-m)}{m}\right        ]        \times
\left[\frac{B(j-1-m)}{m}, \frac{B(j-m)}{m}\right]</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mn>2</mn><msup><mi>Φ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">B  = 2 \Phi^{-1}(1 -
\alpha/2)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>64</mn></mrow><annotation encoding="application/x-tex">m=64</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>≤</mo><mn>2</mn><mi>m</mi></mrow><annotation encoding="application/x-tex">1 \leq i,j \leq 2m</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">64</span></span>
<span><span class="va">map_01</span> <span class="op">&lt;-</span> <span class="va">map_01_0.05</span></span>
<span><span class="va">map_quad</span> <span class="op">&lt;-</span> <span class="va">map_quad_0.05</span></span>
<span><span class="va">map_quad_trunc</span> <span class="op">&lt;-</span> <span class="va">map_quad_0.05_0.1</span></span>
<span><span class="va">map_01_t</span> <span class="op">&lt;-</span> <span class="va">map_01_0.05_t50</span></span>
<span><span class="va">map_quad_t</span> <span class="op">&lt;-</span> <span class="va">map_quad_0.05_t50</span></span>
<span><span class="va">map_quad_trunc_t</span> <span class="op">&lt;-</span> <span class="va">map_quad_0.05_0.1_t50</span></span></code></pre></div>
<p>For instance, this is what <code>map_quad</code> looks like:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">map_quad</span><span class="op">)</span></span></code></pre></div>
<p><img src="mediation-test_files/figure-html/show-map-quad-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Had <code>m</code> been different (and <code>alpha</code>,
<code>truncation</code>, <code>n_obs</code> for that matter too), we
would have relied on the function
<code>compute_map_rejection_probs</code> to compute the corresponding
maps.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">alpha</span> <span class="op">==</span> <span class="fl">0.05</span> <span class="op">&amp;</span> <span class="va">m</span> <span class="op">==</span> <span class="fl">64</span> <span class="op">&amp;</span> <span class="va">truncation</span> <span class="op">==</span> <span class="fl">0.1</span> <span class="op">&amp;</span> <span class="va">n_obs</span> <span class="op">==</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">map_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_map_rejection_probs.html">compute_map_rejection_probs</a></span><span class="op">(</span></span>
<span>        alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>        K <span class="op">=</span> <span class="va">m</span>,</span>
<span>        loss <span class="op">=</span> <span class="st">"0-1"</span>,</span>
<span>        truncation <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        return_solver <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">map_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_map_rejection_probs.html">compute_map_rejection_probs</a></span><span class="op">(</span></span>
<span>        alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>        K <span class="op">=</span> <span class="va">m</span>,</span>
<span>        loss <span class="op">=</span> <span class="st">"quad"</span>,</span>
<span>        truncation <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        return_solver <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">map_quad_trunc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_map_rejection_probs.html">compute_map_rejection_probs</a></span><span class="op">(</span></span>
<span>        alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>        K <span class="op">=</span> <span class="va">m</span>,</span>
<span>        loss <span class="op">=</span> <span class="st">"quad"</span>,</span>
<span>        truncation <span class="op">=</span> <span class="va">truncation</span>,</span>
<span>        return_solver <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">map_01_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_map_rejection_probs.html">compute_map_rejection_probs</a></span><span class="op">(</span></span>
<span>        alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>        K <span class="op">=</span> <span class="va">m</span>,</span>
<span>        loss <span class="op">=</span> <span class="st">"0-1"</span>,</span>
<span>        sample_size <span class="op">=</span> <span class="va">n_obs</span>,</span>
<span>        truncation <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        return_solver <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">map_quad_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_map_rejection_probs.html">compute_map_rejection_probs</a></span><span class="op">(</span></span>
<span>        alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>        K <span class="op">=</span> <span class="va">m</span>,</span>
<span>        loss <span class="op">=</span> <span class="st">"quad"</span>,</span>
<span>        sample_size <span class="op">=</span> <span class="va">n_obs</span>,</span>
<span>        truncation <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        return_solver <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">map_quad_trunc_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_map_rejection_probs.html">compute_map_rejection_probs</a></span><span class="op">(</span></span>
<span>        alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>        K <span class="op">=</span> <span class="va">m</span>,</span>
<span>        loss <span class="op">=</span> <span class="st">"quad"</span>,</span>
<span>        sample_size <span class="op">=</span> <span class="va">n_obs</span>,</span>
<span>        truncation <span class="op">=</span> <span class="va">truncation</span>,</span>
<span>        return_solver <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-testing-procedures">Other testing procedures<a class="anchor" aria-label="anchor" href="#other-testing-procedures"></a>
</h3>
<p>Our minimax optimal and Bayes risk optimal tests will be compared to
the delta method, joint significance, and vGvG tests.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delta_method_test</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Zn</span>, <span class="va">alpha</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Zn</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Zn</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">Zn</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">joint_significance_test</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Zn</span>, <span class="va">alpha</span>, <span class="va">quantile_function</span> <span class="op">=</span> <span class="va">qnorm</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Zn</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu">quantile_function</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Zn</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu">quantile_function</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">vGvG_test</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Zn</span>, <span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">alpha</span> <span class="op">==</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">tabs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>            <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.</span>, <span class="fl">0.1</span>, <span class="fl">0.11</span>, <span class="fl">0.13</span>, <span class="fl">0.14</span>, <span class="fl">0.15</span>, <span class="fl">1.35</span>, <span class="fl">1.36</span>, <span class="fl">1.37</span>,</span>
<span>                   <span class="fl">1.44</span>, <span class="fl">1.45</span>, <span class="fl">2.05</span>, <span class="fl">2.06</span>, <span class="fl">2.07</span>, <span class="fl">2.08</span>, <span class="fl">2.09</span>, <span class="fl">2.1</span><span class="op">)</span></span>
<span>            <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.</span>, <span class="fl">0.1</span>, <span class="fl">0.106723</span>, <span class="fl">0.106723</span>, <span class="fl">0.106724</span>, <span class="fl">0.106724</span>,</span>
<span>                   <span class="fl">1.30583</span>, <span class="fl">1.31286</span>, <span class="fl">1.3131</span>, <span class="fl">1.3131</span>, <span class="fl">1.3175</span>, <span class="fl">1.9175</span>,</span>
<span>                   <span class="fl">1.9275</span>, <span class="fl">1.9375</span>, <span class="fl">1.9475</span>, <span class="fl">1.9575</span>, <span class="fl">1.95996</span><span class="op">)</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">tabs</span> <span class="op">&gt;=</span> <span class="fl">2.1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, xout <span class="op">=</span> <span class="va">tabs</span><span class="op">)</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Zn</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Zn</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span></span>
<span>            <span class="fu">g</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Zn</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Zn</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Zn</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="scenario-a">2 Scenario (a)<a class="anchor" aria-label="anchor" href="#scenario-a"></a>
</h2>
<p>We first initialize the vectors that will receive the empirical
powers.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">pow_nms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pow_minimax"</span>,  <span class="st">"pow_minimax_trunc"</span>, <span class="st">"pow_minimax_pval"</span>,</span>
<span>             <span class="st">"pow_Bayes_01"</span>,  <span class="st">"pow_Bayes_quad"</span>,  <span class="st">"pow_Bayes_quad_constr"</span>, </span>
<span>             <span class="st">"pow_delta"</span>, <span class="st">"pow_js"</span>, <span class="st">"pow_vGvG"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">pow</span> <span class="kw">in</span> <span class="va">pow_nms</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="va">pow</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, envir <span class="op">=</span> <span class="va">.GlobalEnv</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We are now in a position to conduct the Monte Carlo analysis. To
avoid unnecessary repetitions, we define a function called
<code>run_simulation</code> that we will call repeatedly.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delta_x</span> <span class="op">&lt;-</span> <span class="va">delta_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.4</span>, length.out <span class="op">=</span> <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">run_simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co">## ########## ##</span></span>
<span>        <span class="co">## simulating ##</span></span>
<span>        <span class="co">## ########## ##</span></span>
<span>        <span class="va">Zn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">delta_x</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="va">delta_y</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="co">## ####### ##</span></span>
<span>        <span class="co">## testing ##</span></span>
<span>        <span class="co">## ####### ##</span></span>
<span>        <span class="va">R_minimax</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mediation_test_minimax.html">mediation_test_minimax</a></span><span class="op">(</span><span class="va">Zn</span>,</span>
<span>                                            alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>                                            truncation <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                            sample_size <span class="op">=</span> <span class="va">sample_size</span>,</span>
<span>                                            compute_pvals <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="va">R_minimax_pval</span> <span class="op">&lt;-</span> <span class="va">R_minimax</span><span class="op">$</span><span class="va">pval</span> <span class="op">&lt;=</span> <span class="va">alpha</span></span>
<span>        <span class="va">R_minimax_trunc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mediation_test_minimax.html">mediation_test_minimax</a></span><span class="op">(</span><span class="va">Zn</span>,</span>
<span>                                                  alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>                                                  truncation <span class="op">=</span> <span class="va">truncation</span>,</span>
<span>                                                  sample_size <span class="op">=</span> <span class="va">sample_size</span>,</span>
<span>                                                  compute_pvals <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.infinite</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">R_Bayes_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mediation_test_Bayes.html">mediation_test_Bayes</a></span><span class="op">(</span><span class="va">Zn</span>,</span>
<span>                                               <span class="va">map_01</span>,</span>
<span>                                               truncation <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>            <span class="va">R_Bayes_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mediation_test_Bayes.html">mediation_test_Bayes</a></span><span class="op">(</span><span class="va">Zn</span>,</span>
<span>                                                 <span class="va">map_quad</span>,</span>
<span>                                                 truncation <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>            <span class="va">R_Bayes_quad_constr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mediation_test_Bayes.html">mediation_test_Bayes</a></span><span class="op">(</span><span class="va">Zn</span>,</span>
<span>                                                        <span class="va">map_quad_trunc</span>,</span>
<span>                                                        truncation <span class="op">=</span> <span class="va">truncation</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">R_Bayes_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mediation_test_Bayes.html">mediation_test_Bayes</a></span><span class="op">(</span><span class="va">Zn</span>,</span>
<span>                                               <span class="va">map_01_t</span>,</span>
<span>                                               truncation <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                               sample_size <span class="op">=</span> <span class="va">sample_size</span><span class="op">)</span></span>
<span>            <span class="va">R_Bayes_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mediation_test_Bayes.html">mediation_test_Bayes</a></span><span class="op">(</span><span class="va">Zn</span>,</span>
<span>                                                 <span class="va">map_quad_t</span>,</span>
<span>                                                 truncation <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                                 sample_size <span class="op">=</span> <span class="va">sample_size</span><span class="op">)</span></span>
<span>            <span class="va">R_Bayes_quad_constr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mediation_test_Bayes.html">mediation_test_Bayes</a></span><span class="op">(</span><span class="va">Zn</span>,</span>
<span>                                                        <span class="va">map_quad_trunc_t</span>,</span>
<span>                                                        truncation <span class="op">=</span> <span class="va">truncation</span>,</span>
<span>                                                        sample_size <span class="op">=</span> <span class="va">sample_size</span><span class="op">)</span>            </span>
<span>        <span class="op">}</span> </span>
<span>        <span class="va">R_delta</span> <span class="op">&lt;-</span> <span class="fu">delta_method_test</span><span class="op">(</span><span class="va">Zn</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span>        <span class="va">R_js</span> <span class="op">&lt;-</span> <span class="fu">joint_significance_test</span><span class="op">(</span><span class="va">Zn</span>, <span class="va">alpha</span>, <span class="va">quantile_function</span><span class="op">)</span></span>
<span>        <span class="va">R_vGvG</span> <span class="op">&lt;-</span> <span class="fu">vGvG_test</span><span class="op">(</span><span class="va">Zn</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span>        <span class="co">## ################ ##</span></span>
<span>        <span class="co">## evaluating power ##</span></span>
<span>        <span class="co">## ################ ##</span></span>
<span>        <span class="va">pow_minimax</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">R_minimax</span><span class="op">$</span><span class="va">decision</span><span class="op">)</span></span>
<span>        <span class="va">pow_minimax_pval</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">R_minimax_pval</span><span class="op">)</span></span>
<span>        <span class="va">pow_minimax_trunc</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">R_minimax_trunc</span><span class="op">$</span><span class="va">decision</span><span class="op">)</span></span>
<span>        <span class="va">pow_Bayes_01</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">R_Bayes_01</span><span class="op">$</span><span class="va">decision</span><span class="op">)</span></span>
<span>        <span class="va">pow_Bayes_quad</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">R_Bayes_quad</span><span class="op">$</span><span class="va">decision</span><span class="op">)</span></span>
<span>        <span class="va">pow_Bayes_quad_constr</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">R_Bayes_quad_constr</span><span class="op">$</span><span class="va">decision</span><span class="op">)</span></span>
<span>        <span class="va">pow_delta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">R_delta</span><span class="op">)</span></span>
<span>        <span class="va">pow_js</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">R_js</span><span class="op">)</span></span>
<span>        <span class="va">pow_vGvG</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">R_vGvG</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pow_minimax</span>, <span class="va">pow_minimax_trunc</span>, <span class="va">pow_Bayes_01</span>, <span class="va">pow_Bayes_quad</span>,</span>
<span>         <span class="va">pow_Bayes_quad_constr</span>, <span class="va">pow_delta</span>, <span class="va">pow_js</span>, <span class="va">pow_minimax_pval</span>, <span class="va">pow_vGvG</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## ###################### ##</span></span>
<span><span class="co">## running the simulation ##</span></span>
<span><span class="co">## ###################### ##</span></span>
<span><span class="va">pow_a</span> <span class="op">&lt;-</span> <span class="fu">run_simulation</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ####################### ##</span></span>
<span><span class="co">## colllecting the results ##</span></span>
<span><span class="co">## ####################### ##</span></span>
<span><span class="va">pow_scenario_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">delta_x</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>                         power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pow_a</span><span class="op">)</span>,</span>
<span>                         test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"MMO"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"MMO trunc"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"BRO 0-1"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"BRO quad"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"BRO q-cnst"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Delta"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"JS"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"MMO pval"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"vGvG"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig_scenario_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pow_scenario_a</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">delta</span>, y <span class="op">=</span> <span class="va">power</span>, group <span class="op">=</span> <span class="va">test</span>,</span>
<span>        color <span class="op">=</span> <span class="va">test</span>,</span>
<span>        <span class="op">)</span>,</span>
<span>        linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">alpha</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">fig_scenario_a</span><span class="op">)</span></span></code></pre></div>
<p><img src="mediation-test_files/figure-html/scenario-a-2-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Apart from the minimax optimal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value-based
test, all of the minimax optimal and Bayes risk optimal tests and the
vGvG test have very close to nominal type 1 error at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>δ</mi><mi>x</mi></msub><mo>,</mo><msub><mi>δ</mi><mi>y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(\delta_x,\delta_y)=(0,0)</annotation></semantics></math>.
All of these tests greatly outperform the delta method and joint
significance tests in terms of power for smaller values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>x</mi></msub><mo>=</mo><msub><mi>δ</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">\delta_x=\delta_y</annotation></semantics></math>,
with the minimax optimal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value-based
test having power somewhere in between, but converging more quickly to
the other tests.</p>
<p>The delta method test remains very conservative over the entire range
of parameter values. All of the tests except for the delta method test
begin to converge in power closer to 0.4. The minimax optimal (apart
from the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
based test), Bayes risk optimal, and vGvG tests perform very similarly
over the range of parameter values, with the quadratic loss versions of
the Bayes risk optimal test trading off some power loss in the 0.1–0.2
range for a slight improvement in power in the 0.3–0.4 range,
demonstrating the greater emphasis the quadratic loss places on larger
alternatives. The truncated minimax optimal test begins slightly
conservative relative to 0.05, but catches up with the most powerful
tests fairly quickly.</p>
<p>Despite not being similar tests, the Bayes risk optimal and vGvG
tests suffer very little in terms of power near the least favorable
distribution at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>δ</mi><mi>x</mi></msub><mo>,</mo><msub><mi>δ</mi><mi>y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(\delta_x,\delta_y)=(0,0)</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="scenario-b">3 Scenario (b)<a class="anchor" aria-label="anchor" href="#scenario-b"></a>
</h2>
<p>We now turn to scenario (b).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delta_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.6</span>, length.out <span class="op">=</span> <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">delta_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">delta_x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ###################### ##</span></span>
<span><span class="co">## running the simulation ##</span></span>
<span><span class="co">## ###################### ##</span></span>
<span><span class="va">pow_b</span> <span class="op">&lt;-</span> <span class="fu">run_simulation</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ####################### ##</span></span>
<span><span class="co">## colllecting the results ##</span></span>
<span><span class="co">## ####################### ##</span></span>
<span><span class="va">pow_scenario_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">delta_x</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>                         power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pow_b</span><span class="op">)</span>,</span>
<span>                         test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"MMO"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"MMO trunc"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"BRO 0-1"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"BRO quad"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"BRO q-cnst"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Delta"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"JS"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"MMO pval"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"vGvG"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig_scenario_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pow_scenario_b</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">delta</span>, y <span class="op">=</span> <span class="va">power</span>, group <span class="op">=</span> <span class="va">test</span>,</span>
<span>        color <span class="op">=</span> <span class="va">test</span>,</span>
<span>        <span class="op">)</span>,</span>
<span>        linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">alpha</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">fig_scenario_b</span><span class="op">)</span></span></code></pre></div>
<p><img src="mediation-test_files/figure-html/scenario-b-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The trends are largely the same as in scenario (a). The main
difference is that the quadratic loss versions of the Bayes risk optimal
test are slightly conservative with respect to 0.05 under the null,
albeit less conservative than the minimax optimal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value-based
test.</p>
<p>Once again, these tests trade off some power loss for smaller values
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mi>x</mi></msub><annotation encoding="application/x-tex">\delta_x</annotation></semantics></math>
(values less than about 0.25) for slightly improved power for larger
values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mi>x</mi></msub><annotation encoding="application/x-tex">\delta_x</annotation></semantics></math>
(from about 0.35–0.55). Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mi>y</mi></msub><annotation encoding="application/x-tex">\delta_y</annotation></semantics></math>
is fixed at 0.2, power for all tests appears to plateau a little under
0.3.</p>
</div>
<div class="section level2">
<h2 id="scenario-c">4 Scenario (c)<a class="anchor" aria-label="anchor" href="#scenario-c"></a>
</h2>
<p>We now turn to scenario (c).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delta_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.8</span>, length.out <span class="op">=</span> <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">delta_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">delta_x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ###################### ##</span></span>
<span><span class="co">## running the simulation ##</span></span>
<span><span class="co">## ###################### ##</span></span>
<span><span class="va">pow_c</span> <span class="op">&lt;-</span> <span class="fu">run_simulation</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ####################### ##</span></span>
<span><span class="co">## colllecting the results ##</span></span>
<span><span class="co">## ####################### ##</span></span>
<span><span class="va">pow_scenario_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">delta_x</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>                         power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pow_c</span><span class="op">)</span>,</span>
<span>                         test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"MMO"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"MMO trunc"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"BRO 0-1"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"BRO quad"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"BRO q-cnst"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Delta"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"JS"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"MMO pval"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"vGvG"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig_scenario_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pow_scenario_c</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">delta</span>, y <span class="op">=</span> <span class="va">power</span>, group <span class="op">=</span> <span class="va">test</span>,</span>
<span>        color <span class="op">=</span> <span class="va">test</span>,</span>
<span>        <span class="op">)</span>,</span>
<span>        linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">alpha</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">fig_scenario_c</span><span class="op">)</span></span></code></pre></div>
<p><img src="mediation-test_files/figure-html/scenario-c-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>All tests approximately preserve type 1 error. Moreover, the
performances of all tests except the delta method test converge by
around
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>x</mi></msub><mo>=</mo><mn>0.55</mn></mrow><annotation encoding="application/x-tex">\delta_x=0.55</annotation></semantics></math>.</p>
<p>However, the minimax optimal test exhibits some anti-conservative
behavior due to the normal approximation being a bit too concentrated
for a sample size of 50. This motivates conducting again the simulation
study in scenario (c), substituting a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-distribution
for the standard normal approximation – see the next section.</p>
</div>
<div class="section level2">
<h2 id="scenario-c-revisited">5 Scenario (c) revisited<a class="anchor" aria-label="anchor" href="#scenario-c-revisited"></a>
</h2>
<p>We revisit scenario (c), using a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-distribution
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(n-1)</annotation></semantics></math>
degrees of freedom instead of the standard normal approximation in the
vGvG, minimax optimal, and Bayes optimal tests. For this purpose, we
adapt the function <code>vGvG_test</code> and simply redefine the
objects <code>sample_size</code>, <code>quantile_function</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delta_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.8</span>, length.out <span class="op">=</span> <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">delta_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">delta_x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vGvG_test</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Zn</span>, <span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">alpha</span> <span class="op">==</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">tabs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>            <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.</span>, <span class="fl">0.1</span>, <span class="fl">0.11</span>, <span class="fl">0.13</span>, <span class="fl">0.14</span>, <span class="fl">0.15</span>, <span class="fl">1.35</span>, <span class="fl">1.36</span>, <span class="fl">1.37</span>,</span>
<span>                   <span class="fl">1.44</span>, <span class="fl">1.45</span>, <span class="fl">2.05</span>, <span class="fl">2.06</span>, <span class="fl">2.07</span>, <span class="fl">2.08</span>, <span class="fl">2.09</span>, <span class="fl">2.1</span><span class="op">)</span></span>
<span>            <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.</span>, <span class="fl">0.1</span>, <span class="fl">0.106723</span>, <span class="fl">0.106723</span>, <span class="fl">0.106724</span>, <span class="fl">0.106724</span>,</span>
<span>                   <span class="fl">1.30583</span>, <span class="fl">1.31286</span>, <span class="fl">1.3131</span>, <span class="fl">1.3131</span>, <span class="fl">1.3175</span>, <span class="fl">1.9175</span>,</span>
<span>                   <span class="fl">1.9275</span>, <span class="fl">1.9375</span>, <span class="fl">1.9475</span>, <span class="fl">1.9575</span>, <span class="fl">1.95996</span><span class="op">)</span></span>
<span>            <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">n_obs</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>            <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">n_obs</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">tabs</span> <span class="op">&gt;=</span> <span class="fl">2.1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, df <span class="op">=</span> <span class="va">n_obs</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, xout <span class="op">=</span> <span class="va">tabs</span><span class="op">)</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Zn</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Zn</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span></span>
<span>            <span class="fu">g</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Zn</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Zn</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Zn</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="va">n_obs</span></span>
<span><span class="va">quantile_function</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="va">t</span>, df <span class="op">=</span> <span class="va">n_obs</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ###################### ##</span></span>
<span><span class="co">## running the simulation ##</span></span>
<span><span class="co">## ###################### ##</span></span>
<span><span class="va">pow_d</span> <span class="op">&lt;-</span> <span class="fu">run_simulation</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = 0,</span></span>
<span><span class="co">#&gt; sample_size = sample_size, : Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_minimax(Zn, alpha = alpha, truncation = truncation, :</span></span>
<span><span class="co">#&gt; Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_01_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_t, truncation = 0, sample_size =</span></span>
<span><span class="co">#&gt; sample_size): Coercing argument 'sample_size' to an integer.</span></span>
<span><span class="co">#&gt; Warning in mediation_test_Bayes(Zn, map_quad_trunc_t, truncation = truncation,</span></span>
<span><span class="co">#&gt; : Coercing argument 'sample_size' to an integer.</span></span>
<span></span>
<span><span class="co">## ####################### ##</span></span>
<span><span class="co">## colllecting the results ##</span></span>
<span><span class="co">## ####################### ##</span></span>
<span><span class="va">pow_scenario_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">delta_x</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>                         power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pow_d</span><span class="op">)</span>,</span>
<span>                         test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"MMO"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"MMO trunc"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"BRO 0-1"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"BRO quad"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"BRO q-cnst"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Delta"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"JS"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"MMO pval"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"vGvG"</span>, <span class="va">P</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig_scenario_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pow_scenario_d</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">delta</span>, y <span class="op">=</span> <span class="va">power</span>, group <span class="op">=</span> <span class="va">test</span>,</span>
<span>        color <span class="op">=</span> <span class="va">test</span>,</span>
<span>        <span class="op">)</span>,</span>
<span>        linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">alpha</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">fig_scenario_d</span><span class="op">)</span></span></code></pre></div>
<p><img src="mediation-test_files/figure-html/scenario-d-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The use of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-distribution
approximation has the expected effect. The type 1 error is now much
closer to 0.05 across the entire range of the null hypothesis parameter
space we consider for the vGvG test, minimax optimal test and Bayes
optimal with 0-1 loss function. The performances of all tests except the
delta method converge by around
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>x</mi></msub><mo>=</mo><mn>0.55</mn></mrow><annotation encoding="application/x-tex">\delta_x=0.55</annotation></semantics></math>.</p>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-vangarderen2022" class="csl-entry">
Garderen, Kees Jan van, and Noud van Giersbergen. 2022. <span>“A Nearly
Similar Powerful Test for Mediation.”</span> <em>arXiv Preprint
arXiv:2012.11342</em>. <a href="https://arxiv.org/abs/2012.11342" class="external-link">https://arxiv.org/abs/2012.11342</a>.
</div>
<div id="ref-Miles2024" class="csl-entry">
Miles, Caleb H., and Antoine Chambaz. 2024. <span>“Optimal Tests of the
Composite Null Hypothesis Arising in Mediation Analysis.”</span> <a href="https://arxiv.org/abs/2107.07575" class="external-link">https://arxiv.org/abs/2107.07575</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Antoine Chambaz, Caleb Miles.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
